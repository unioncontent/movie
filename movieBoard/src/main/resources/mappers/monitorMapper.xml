<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.union.mapper.MonitorMapper">

	<insert id="create">
		insert into monitor_data (monitor_domain, monitor_site, monitor_user)
		values (#{monitor_domain}, #{monitor_site}, #{monitor_user})
	
	</insert>


	<select id="pageAll" resultType="MonitorVO">
		select *
		from monitor_data
	
	</select>
	
	<select id="checkLast" parameterType="String" resultType="MonitorVO">
	
		<if test="_parameter == 'media'.toString()">
			select media_title title, url url, createDate 
			from media_data 
			where createDate >=  date_format(now(), '%x-%m-%d') 
			order by createDate desc 
			limit 1
		</if>
		
		<if test="_parameter == 'portal'.toString()">
			select portal_title title, url url, createDate
			from portal_data 
			where createDate >=  date_format(now(), '%x-%m-%d') 
			order by createDate desc 
			limit 1
		</if>
		
		<if test="_parameter == 'community'.toString()">
			select community_title title, url url, createDate 
			from community_data 
			where createDate >=  date_format(now(), '%x-%m-%d') 
			order by createDate desc 
			limit 1
		</if>
	</select>
	
	<select id="portalBMonitor" parameterType="Map" resultType="PortalVO">
		select * 
		from portal_data 
		where portal_type='blog' and portal_name='naver' and createDate >=  date_format(now(), '%x-%m-%d')
		order by createDate desc 
		limit 1;
	</select>
	<select id="portalCMonitor" parameterType="Map" resultType="PortalVO">
		select * 
		from portal_data 
		where portal_type='cafe' and portal_name='naver' and createDate >=  date_format(now(), '%x-%m-%d')
		order by createDate desc 
		limit 1;
	</select>
	<select id="portalWMonitor" parameterType="Map" resultType="PortalVO">
		select * 
		from portal_data 
		where portal_type='webdoc' and portal_name='naver' and createDate >=  date_format(now(), '%x-%m-%d')
		order by createDate desc 
		limit 1;
	</select>
</mapper>